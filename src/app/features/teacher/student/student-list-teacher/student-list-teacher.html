<div class="card">
    <p-table
        #dt
        [value]="students"
        dataKey="id"
        [rows]="10"
        [rowsPerPageOptions]="[10, 25, 50]"
        [loading]="loading"
        [paginator]="true"
        [globalFilterFields]="[
            'user.firstName',
            'user.lastName',
            'user.email',
            'academicProfile.ecole',
            'academicProfile.program'
        ]"
        [tableStyle]="{ 'min-width': '50rem' }"
    >


        <!-- Caption / Global Search -->
        <ng-template #caption>
            <div class="flex">
                <div class="text-3xl font-bold">Students</div>
                <p-iconfield iconPosition="left" class="ml-auto">
                    <p-inputicon>
                        <i class="pi pi-search"></i>
                    </p-inputicon>
                    <input
                        pInputText
                        type="text"
                        (input)="dt.filterGlobal($any($event.target).value, 'contains')"
                        placeholder="Search student..."
                    />
                </p-iconfield>
            </div>
        </ng-template>

        <!-- Header -->
        <ng-template #header>
            <tr>
                <th style="width:20%">Full Name</th>
                <th style="width:20%">Email</th>
                <th style="width:20%">School</th>
                <th style="width:20%">Program</th>
                <th style="width:10%">Status</th>
                <!--<th style="width:10%">Enabled</th>-->
            </tr>

            <!-- Filters -->
            <tr>
                <th>
                    <p-columnFilter
                        field="user.firstName"
                        type="text"
                        placeholder="Search name"
                        filterOn="input">
                    </p-columnFilter>
                </th>

                <th>
                    <p-columnFilter
                        field="user.email"
                        type="text"
                        placeholder="Search email">
                    </p-columnFilter>
                </th>

                <th>
                    <p-columnFilter
                        field="academicProfile.ecole"
                        type="text"
                        placeholder="Search school">
                    </p-columnFilter>
                </th>

                <th>
                    <p-columnFilter
                        field="academicProfile.program"
                        type="text"
                        placeholder="Search program">
                    </p-columnFilter>
                </th>

                <th>
                    <p-columnFilter
                        field="user.status"
                        matchMode="equals"
                        [showMenu]="false">
                        <ng-template #filter let-filter="filterCallback">
                            <p-select
                                [options]="userStatuses"
                                placeholder="Any"
                                [showClear]="true"
                                (onChange)="filter($event.value)">
                            </p-select>
                        </ng-template>
                    </p-columnFilter>
                </th>

                <!-- <th>
                    <p-columnFilter type="boolean" field="user.enabled"></p-columnFilter>
                </th> -->
            </tr>
        </ng-template>

        <!-- Body -->
        <ng-template #body let-student>
            <tr>
                <td>
                    {{ student.user.firstName }} {{ student.user.lastName }}
                </td>

                <td>
                    {{ student.user.email }}
                </td>

                <td>
                    {{ student.academicProfile?.ecole || '-' }}
                </td>

                <td>
                    {{ student.academicProfile?.program || '-' }}
                </td>

                <td>
                    <p-tag
                        [value]="student.user.status.toString()"
                        [severity]="getUserStatusSeverity(student.user.status.toString())">
                    </p-tag>
                </td>

                <!-- <td class="text-center">
                    <i
                        class="pi"
                        [ngClass]="{
                            'pi-check-circle text-green-500': student.user.enabled,
                            'pi-times-circle text-red-500': !student.user.enabled
                        }">
                    </i>
                </td> -->
            </tr>
        </ng-template>

        <!-- Empty -->
        <ng-template #emptymessage>
            <tr>
                <td colspan="6">No students found.</td>
            </tr>
        </ng-template>

    </p-table>
</div>
